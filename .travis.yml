matrix:
  include:
    - language: android
      sudo: required
      dist: trusty
      env:
        global:
          - ANDROID_API_LEVEL=28
          - ANDROID_BUILD_TOOLS_VERSION=28.0.3
          - ANDROID_ABI=armeabi-v7a
      android:
        components:
          - tools
          - platform-tools
          - tools
          - extra-android-m2repository
        licenses:
          - android-sdk-preview-license-52d11cd2
          - android-sdk-license-.+
          - google-gdk-license-.+
      before_install:
        - touch $HOME/.android/repositories.cfg
        - yes | sdkmanager "platforms;android-28"
        - yes | sdkmanager "build-tools;28.0.3"
        - openssl aes-256-cbc -K $encrypted_244650427dda_key -iv $encrypted_244650427dda_iv -in google-services.json.enc -out Client/app/google-services.json -d
      before_cache:
        - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
        - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
      cache:
        directories:
          - "$HOME/.gradle/caches/"
          - "$HOME/.gradle/wrapper/"
          - "$HOME/.android/build-cache"
      before_script:
        - cd Client
        - chmod +x gradlew
      script:
        - "./gradlew clean build"
        - "./gradlew test"
    - language: node_js
      node_js:
        - 13.13.0
      script:
        - npm test
